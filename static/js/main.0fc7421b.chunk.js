(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{165:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return o});var n=a(7),r=a(258),s=a(342);function o(t){var a,o,c,i,l=s.parse(t),p=(o=n.c,a=o.replace(/-/g,"+").replace(/_/g,"/"),e.from?e.from(a,"base64"):new e(a,"base64")),u=(c=p,i=l.path,r.createHmac("sha1",c).update(i).digest("base64").replace(/\+/g,"-").replace(/\//g,"_"));return s.format(l)+"&signature="+u}}).call(this,a(17).Buffer)},168:function(e,t,a){e.exports=a(349)},173:function(e,t,a){},259:function(e,t){},261:function(e,t){},295:function(e,t){},296:function(e,t){},349:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(31),o=a.n(s),c=(a(173),a(19)),i=a(20),l=a(23),p=a(21),u=a(22),d=(a(74),a(60)),h=a.n(d),m=a(32),f=a.n(m),g=a(70),y=a.n(g),v=a(43),b=a.n(v),E=a(94),k=a.n(E),_=a(56),j=a.n(_),O=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,{bg:"light",expand:"lg"},r.a.createElement(h.a.Brand,{href:"#home"},"Project Landmark"),r.a.createElement(h.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(h.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(y.a,{className:"mr-auto"},r.a.createElement(y.a.Link,{href:"#home"},"Home"),r.a.createElement(y.a.Link,{href:"#link"},"Link"),r.a.createElement(b.a,{title:"Dropdown",id:"basic-nav-dropdown"},r.a.createElement(b.a.Item,{href:"#action/3.1"},"Action"),r.a.createElement(b.a.Item,{href:"#action/3.2"},"Another action"),r.a.createElement(b.a.Item,{href:"#action/3.3"},"Something"),r.a.createElement(b.a.Divider,null),r.a.createElement(b.a.Item,{href:"#action/3.4"},"Separated link"))),r.a.createElement(f.a,{inline:!0},r.a.createElement(k.a,{type:"text",placeholder:"Search",className:"mr-sm-2"}),r.a.createElement(j.a,{variant:"outline-success"},"Search"))))}}]),t}(r.a.Component),C=a(57),w=a(2),S=a(95),P=a.n(S),U=a(7),A="https://maps.googleapis.com/maps/api/geocode/json?",M="AIzaSyAApJlSsL7fsf9ElKRHLLOhEM2pZM00-ho";function x(e,t,a){var n,r=e.coords.lat,s=e.coords.lng;fetch(U.a+"places/nearby/"+r+"/"+s+"/"+t,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return n=e.headers.get("Pragma"),e.json()}).then(function(e){return a(e,n)}).catch(function(e){return console.error("Error:",e)})}var z="business_type:updateBusinessType";function T(e){return{type:z,payload:{business_type:e}}}var I="state:updateReady";var R=a(27),D=a(10),B=a(25),L=a.n(B),N=a(35),Z=a(71),F=a.n(Z),G="address:updateAddress";var H="zip:updateZip";var K="state:updateState";var W=Object(D.a)(function(e){return e.active_place},function(e){return e}),Y=Object(D.a)(function(e){return e.address},function(e){return e}),J=Object(D.a)(function(e){return e.business_type},function(e){return e}),Q=Object(D.a)(function(e){return e.data_range},function(e){return e}),X=Object(D.a)(function(e){return e.places},function(e){return e}),V=Object(D.a)(function(e){return e.state},function(e){return e}),q=Object(D.a)(function(e){return e.tract},function(e){return e}),$=Object(D.a)(function(e){return e.user},function(e){return e}),ee=Object(D.a)(function(e){return e.zip},function(e){return e}),te=Object(D.a)(function(e){return e.ready},function(e){return e}),ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){a.setState({address:e})},a.handleSelect=function(){var e=Object(N.a)(L.a.mark(function e(t){var n,r,s,o,c,i,l;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.handleChange(t),e.next=3,Object(Z.geocodeByAddress)(t).then(function(e){var t=!0,a=!1,i=void 0;try{for(var l,p=e[0].address_components[Symbol.iterator]();!(t=(l=p.next()).done);t=!0){var u=l.value,d=!0,h=!1,m=void 0;try{for(var f,g=u.types[Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var y=f.value;"street_number"==y&&(r=u.long_name),"route"==y&&(s=u.short_name),"locality"==y&&(o=u.long_name),"administrative_area_level_1"==y&&(c=u.short_name),"postal_code"==y&&(n=u.long_name)}}catch(v){h=!0,m=v}finally{try{d||null==g.return||g.return()}finally{if(h)throw m}}}}catch(v){a=!0,i=v}finally{try{t||null==p.return||p.return()}finally{if(a)throw i}}return console.log(e),Object(Z.getLatLng)(e[0])}).then(function(e){return e}).catch(function(e){return console.error("Error",e)});case 3:i=e.sent,(l={}).formatted=t,l.street=r+""+s,l.city=o,l.state=c,l.zip=n,l.coords=i,a.onUpdateAddress(l);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={address:""},a.handleChange=a.handleChange.bind(Object(w.a)(a)),a.onUpdateAddress=a.onUpdateAddress.bind(Object(w.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"onUpdateAddress",value:function(e){this.props.onUpdateAddress(e)}},{key:"render",value:function(){return r.a.createElement(F.a,{value:this.state.address,onChange:this.handleChange,onSelect:this.handleSelect},function(e){var t=e.getInputProps,a=e.suggestions,n=e.getSuggestionItemProps,s=e.loading;return r.a.createElement("div",null,r.a.createElement("input",Object.assign({style:{width:"100%"}},t({placeholder:"Search Places ...",className:"location-search-input"}))),r.a.createElement("div",{className:"autocomplete-dropdown-container"},s&&r.a.createElement("div",null,"Loading..."),a.map(function(e){var t=e.active?"suggestion-item--active":"suggestion-item",a=e.active?{backgroundColor:"#fafafa",cursor:"pointer"}:{backgroundColor:"#ffffff",cursor:"pointer"};return r.a.createElement("div",n(e,{className:t,style:a}),r.a.createElement("span",null,e.description))})))})}}]),t}(r.a.Component),ne=Object(D.a)(Y,J,ee,V,function(e,t,a,n){return{address:e,business_type:t,zip:a,state:n}}),re={onUpdateAddress:function(e){return{type:G,payload:{address:e}}},onUpdateBusinessType:T,onUpdateZip:function(e){return{type:H,payload:{zip:e}}},onUpdateState:function(e){return{type:K,payload:{state:e}}}},se=Object(R.b)(ne,re)(ae),oe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).onUpdateUser=a.onUpdateUser.bind(Object(w.a)(a)),a.onFormChange=a.onFormChange.bind(Object(w.a)(a)),a.onBusinessFormChange=a.onBusinessFormChange.bind(Object(w.a)(a)),a.submitAddress=a.submitAddress.bind(Object(w.a)(a)),a.onUpdateBusinessType=a.onUpdateBusinessType.bind(Object(w.a)(a)),a.getCoords=a.getCoords.bind(Object(w.a)(a)),a.dispatchAddress=a.dispatchAddress.bind(Object(w.a)(a)),a.onUpdateReady=a.onUpdateReady.bind(Object(w.a)(a)),a.onHandleSubmit=a.onHandleSubmit.bind(Object(w.a)(a)),a.state={},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){}},{key:"onUpdateUser",value:function(e){this.props.onUpdateUser(e.target.value)}},{key:"onUpdateBusinessType",value:function(e){this.props.onUpdateBusinessType(e)}},{key:"onFormChange",value:function(e){this.setState(Object(C.a)({},e.target.name,e.target.value))}},{key:"onBusinessFormChange",value:function(e){this.setState(Object(C.a)({},e.target.name,e.target.value)),this.onUpdateBusinessType(e.target.value)}},{key:"onUpdateReady",value:function(e){this.props.onUpdateReady(e)}},{key:"onHandleSubmit",value:function(){this.props.address.toString().length>0?this.onUpdateReady(!0):this.onUpdateReady(!1)}},{key:"submitAddress",value:function(e){void 0!==this.state.street&&void 0!==this.state.city&&void 0!==this.state.state&&void 0!==this.state.zip&&(console.log("Attempt submit"),function(e,t,a,n){var r=e.replace(/ /g,"+"),s=t.replace(/ /g,"+"),o=a.replace(/ /g,"+");fetch(A+"address="+r+",+"+s+",+"+o+"&key="+M).then(function(e){return e.json()}).then(function(e){return n(e)})}(this.state.street,this.state.city,this.state.state,this.getCoords))}},{key:"getCoords",value:function(e){var t=e.results;t.length>1&&console.log("ERROR, Multiple Locations");var a=t[0].geometry.location;this.setState({coords:a}),this.dispatchAddress()}},{key:"dispatchAddress",value:function(){if(void 0!==this.state.street&&void 0!==this.state.city&&void 0!==this.state.state&&void 0!==this.state.zip&&void 0!==this.state.coords){var e={};e.street=this.state.street,e.city=this.state.city,e.state=this.state.state,e.zip=this.state.zip,e.coords=this.state.coords,this.onUpdateAddress(e),this.onUpdateZip(this.state.zip),this.onUpdateState(this.state.state)}}},{key:"render",value:function(){return r.a.createElement("div",{className:"lookup-form-block"},r.a.createElement("br",null),r.a.createElement(f.a.Label,{color:"black"},"Address"),r.a.createElement(se,null),r.a.createElement("br",null),r.a.createElement(f.a.Row,null,r.a.createElement(f.a.Group,{as:P.a,controlId:"formGridZip"},r.a.createElement(f.a.Label,null,"Business Type"),r.a.createElement(f.a.Control,{as:"select",name:"business_type",onChange:this.onBusinessFormChange},r.a.createElement("option",null,"restaurant"),r.a.createElement("option",null,"bar"),r.a.createElement("option",null,"cafe"),r.a.createElement("option",null,"beauty_salon"),r.a.createElement("option",null,"clothing_store"),r.a.createElement("option",null,"convenvience_store"),r.a.createElement("option",null,"locksmith"),r.a.createElement("option",null,"bakery"),r.a.createElement("option",null,"car_dealer"),r.a.createElement("option",null,"supermarket")))),r.a.createElement(f.a,null,r.a.createElement(j.a,{variant:"primary",onClick:this.onHandleSubmit},"Submit")))}}]),t}(r.a.Component),ce=Object(D.a)(J,te,Y,function(e,t,a){return{business_type:e,ready:t,address:a}}),ie={onUpdateBusinessType:T,onUpdateReady:function(e){return{type:I,payload:{ready:e}}}},le=Object(R.b)(ce,ie)(oe),pe=a(59),ue=a.n(pe),de=a(36),he=a.n(de),me=a(34),fe=a.n(me),ge="users:updateUser",ye="users:showError";function ve(){return{type:ye,payload:{user:"ERROR!!"}}}function be(e,t,a){return fetch(U.a+"demo/stats/"+a+"/"+e+"/"+t).then(function(e){return e.json()}).catch(function(e){return console.error(e)})}var Ee="data_range:updateDataRange";var ke="zip code tabulation area",_e=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={},a.onUpdateDataRange=a.onUpdateDataRange.bind(Object(w.a)(a)),a.getData=a.getData.bind(Object(w.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"onUpdateDataRange",value:function(e){var t=e.target.value;"zip"===t?this.props.onUpdateDataRange(ke):"tradeZone"==t&&this.props.onUpdateDataRange("tradeZone")}},{key:"componentDidMount",value:function(){var e=Object(N.a)(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getData",value:function(){var e=Object(N.a)(L.a.mark(function e(){var t=this;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(this.props.lat,this.props.lng,"zip").then(function(e){return t.setState({zipStats:e})});case 2:return e.next=4,be(this.props.lat,this.props.lng,"tradezone").then(function(e){return t.setState({tradeZoneStats:e})});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){console.log(this.state);var e={summary:{gender:{}},race:{},education:{},marital_status:{},employment:{},transportation:{}},t={};this.props.data_range==ke?null!=this.state.zipStats&&(e=this.state.zipStats.social,t=this.state.zipStats.income):"tradeZone"==this.props.data_range&&null!=this.state.tradeZoneStats&&(e=this.state.tradeZoneStats.social,t=this.state.tradeZoneStats.income);var a=function(e){var t=e.name,a=e.data,n=e.key_i;return r.a.createElement(fe.a,null,r.a.createElement(he.a.Toggle,{as:fe.a.Header,eventKey:n},t),r.a.createElement(he.a.Collapse,{eventKey:n},r.a.createElement(fe.a.Body,null,r.a.createElement("div",{style:{overflowX:"auto",overflowY:"auto",width:"100%"}},r.a.createElement(ue.a,{striped:!0,bordered:!0,hover:!0,variant:"dark"},r.a.createElement("tbody",null,Object.entries(a).map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e[0]),r.a.createElement("td",null,e[1]))})))))))};return r.a.createElement("div",{className:this.props.orientation},r.a.createElement("div",{style:{width:"100hv"}}),r.a.createElement("br",null),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("strong",null,"Demographics")),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("button",{className:"map-control_button",onClick:this.onUpdateDataRange,value:"zip",style:{margin:"auto",width:"50%",height:"10%",padding:"0"}},"Zip"),r.a.createElement("button",{className:"map-control_button",onClick:this.onUpdateDataRange,value:"tradeZone",style:{margin:"auto",width:"50%",height:"10%",padding:"0"}},"Trade Zone"),r.a.createElement("br",null)),r.a.createElement(he.a,{defaultActiveKey:"0"},r.a.createElement(fe.a,null,r.a.createElement(he.a.Toggle,{as:fe.a.Header,eventKey:"0"},"General"),r.a.createElement(he.a.Collapse,{eventKey:"0"},r.a.createElement(fe.a.Body,null,r.a.createElement(ue.a,{striped:!0,bordered:!0,hover:!0,variant:"dark"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Business"),r.a.createElement("td",null,this.props.business_type)),r.a.createElement("tr",null,r.a.createElement("td",null,"City"),r.a.createElement("td",null,this.props.city)),r.a.createElement("tr",null,r.a.createElement("td",null,"Street"),r.a.createElement("td",null,this.props.street)),r.a.createElement("tr",null,r.a.createElement("td",null,"Population"),r.a.createElement("td",null,e.summary.population)),r.a.createElement("tr",null,r.a.createElement("td",null,"Median Age"),r.a.createElement("td",null,e.summary.median_age)),r.a.createElement("tr",null,r.a.createElement("td",null,"Median Household Income"),r.a.createElement("td",null,t.median)),r.a.createElement("tr",null,r.a.createElement("td",null,"Males"),r.a.createElement("td",null,e.summary.gender.males)),r.a.createElement("tr",null,r.a.createElement("td",null,"Females"),r.a.createElement("td",null,e.summary.gender.females))))))),r.a.createElement(fe.a,null,r.a.createElement(he.a.Toggle,{as:fe.a.Header,eventKey:"1"},"Social"),r.a.createElement(he.a.Collapse,{eventKey:"1"},r.a.createElement(fe.a.Body,null,r.a.createElement(he.a,{defaultActiveKey:"0"},r.a.createElement(a,{name:"Race",data:e.race,key_i:"0"}),r.a.createElement(a,{name:"Education",data:e.education,key_i:"1"}),r.a.createElement(a,{name:"Employment",data:e.employment,key_i:"2"}),r.a.createElement(a,{name:"Marital Status",data:e.marital_status,key_i:"3"}),r.a.createElement(a,{name:"Transportation",data:e.transportation,key_i:"4"}))))),r.a.createElement(a,{name:"Income",data:t,key_i:"2"})))}}]),t}(r.a.Component),je=Object(D.a)(function(e){return e.address},function(e){return e}),Oe=Object(D.a)(function(e){return e.tract},function(e){return e}),Ce=Object(D.a)(function(e){return e.data_range},function(e){return e}),we=Object(D.a)(Oe,je,Ce,function(e,t,a){return{tract:e,address:t,data_range:a}}),Se={onUpdateDataRange:function(e){return{type:Ee,payload:{data_range:e}}}},Pe=Object(R.b)(we,Se)(_e),Ue=a(167),Ae=a(161),Me=a.n(Ae),xe="places:updatePlaces";var ze="active_place:activatePlace";function Te(e){return{type:ze,payload:{active_place:e}}}var Ie=a(162),Re=a.n(Ie);var De="tract:updateTract";function Be(e,t){for(var a=Le(e.lat),n=Le(e.lng),r=t,s=6371,o=[],c=0;c<1;c++){var i=Le(360*c),l=Math.asin(Math.sin(a)*Math.cos(r/s)+Math.cos(a)*Math.sin(r/s)*Math.cos(i)),p=n+Math.atan2(Math.sin(i)*Math.sin(r/s)*Math.cos(a),Math.cos(r/s)-Math.sin(a)*Math.sin(l)),u={};u.lat=Ne(l),u.lng=Ne(p),o.push(u)}return o}var Le=function(e){return e*(Math.PI/180)},Ne=function(e){return e*(180/Math.PI)},Ze=function(e,t,a,n){return new U.d.maps.Circle({strokeColor:t,strokeOpacity:.5,strokeWeight:4,fillColor:"#00ff00",fillOpacity:0,map:a,center:n,radius:e})},Fe=function(e,t,a,n,r,s){return new U.d.maps.Marker({key:e,position:t,map:a,title:n,icon:r,labelContent:s})};var Ge="http://maps.google.com/mapfiles/ms/icons/yellow-dot.png",He="http://maps.google.com/mapfiles/ms/icons/red-dot.png",Ke="http://maps.google.com/mapfiles/ms/icons/green-dot.png",We=a(163),Ye=a.n(We),Je=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={checked:!0},a.handleChange=a.handleChange.bind(Object(w.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState({checked:e}),this.props.switchFunction(e)}},{key:"render",value:function(){return r.a.createElement("label",{htmlFor:"material-switch"},r.a.createElement(Ye.a,{checked:this.state.checked,onChange:this.handleChange,onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:30,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:20,width:48,className:"react-switch",id:"material-switch"}))}}]),t}(n.Component),Qe=new U.d.maps.InfoWindow,Xe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).updateMarkers=function(e){var t=a.state.markers;Array.from(a.props.places).map(function(n,r){var s=n.id,o="";o=s===a.props.active_place.id?Ke:n.types.includes(a.props.business_type)?He:Ge,1;var c=Fe(r,n.geometry.location,e,n.name,o);t.set(s,{marker:c,place:n})}),a.setState({markers:t}),a.updateInfoWindow(e)},a.updateInfoWindow=function(e){return Array.from(a.state.markers,function(t){var n=Object(Ue.a)(t,2),r=(n[0],n[1]);r.marker.addListener("click",function(){a.onUpdateActivePlace(r.place),a.updatePlaceDetails(function(){Qe.setContent(Re.a.renderToStaticMarkup(a.getInfoContent(r.place))),Qe.marker=r,Qe.open(e,r.marker)})})})},a.getPlaceDetails=function(e,t,a){var n={placeId:t,fields:["formatted_address","opening_hours","website"]};new U.d.maps.places.PlacesService(e).getDetails(n,function(e,t){t===U.d.maps.places.PlacesServiceStatus.OK?a(e):console.log("error",t)})},a.getOpen=function(e){return void 0===e?"Unknown":e.is_open?"Yes":"No"},a.updateMarker=function(e){var t="";t=e.place.id===a.props.active_place.id?Ke:e.place.types.includes(a.props.business_type)?He:Ge,e.marker.setIcon(t)},a.handleSwitch=function(e){e?a.renderCartography():a.clearCartography()},a.state={center:a.props.center,map:void 0,markers:new Map,place_details:new Map,place_photos:new Map,places_cache:new Map,places_count:20,address_line:a.props.address.street+", "+a.props.address.city+" "+a.props.address.state+", "+a.props.address.zip,boundaries:Be(a.props.center,.804),cartography:{},display_cartography:!0,business_type:a.props.business_type},a.onUpdatePlaces=a.onUpdatePlaces.bind(Object(w.a)(a)),a.onUpdateActivePlace=a.onUpdateActivePlace.bind(Object(w.a)(a)),a.onUpdateTract=a.onUpdateTract.bind(Object(w.a)(a)),a.lessPlaces=a.lessPlaces.bind(Object(w.a)(a)),a.loadAllPlaces=a.loadAllPlaces.bind(Object(w.a)(a)),a.loadMorePlaces=a.loadMorePlaces.bind(Object(w.a)(a)),a.loadDefaultPlaces=a.loadDefaultPlaces.bind(Object(w.a)(a)),a.exampleRef=r.a.createRef(),a.updateMarkers=a.updateMarkers.bind(Object(w.a)(a)),a.updateMarker=a.updateMarker.bind(Object(w.a)(a)),a.updateInfoWindow=a.updateInfoWindow.bind(Object(w.a)(a)),a.getopen=a.getOpen.bind(Object(w.a)(a)),a.getPlaceDetails=a.getPlaceDetails.bind(Object(w.a)(a)),a.updatePlaceDetails=a.updatePlaceDetails.bind(Object(w.a)(a)),a.onBusinessFormChange=a.onBusinessFormChange.bind(Object(w.a)(a)),a.loadCartography=a.loadCartography.bind(Object(w.a)(a)),a.renderCartography=a.renderCartography.bind(Object(w.a)(a)),a.getInfoContent=a.getInfoContent.bind(Object(w.a)(a)),a.handleSwitch=a.handleSwitch.bind(Object(w.a)(a)),a.clearCartography=a.clearCartography.bind(Object(w.a)(a)),a.checkIsCity=a.checkIsCity.bind(Object(w.a)(a)),a.onPlacesCountChange=a.onPlacesCountChange.bind(Object(w.a)(a)),a.updateRadii=a.updateRadii.bind(Object(w.a)(a)),a.initCache=a.initCache.bind(Object(w.a)(a)),setInterval(function(){if(!!!Qe.getMap()&&void 0!=Qe.marker){var e="";e=Qe.marker.place.types.includes(a.props.business_type)?He:Ge,Qe.marker.marker.setIcon(e)}},500),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(N.a)(L.a.mark(function e(){var t;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.initCache(),this.loadDefaultPlaces(),e.next=4,this.checkIsCity();case 4:t=e.sent,this.setState({isCity:t}),this.updateRadii();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){this.props.active_place!==e.active_place&&this.props.active_place.toString().length>0&&(this.setState({center:this.props.active_place.geometry.location}),e.active_place.toString().length>0&&this.updateMarker(this.state.markers.get(e.active_place.id)),this.state.markers.get(this.props.active_place.id).marker.setIcon(Ke),U.d.maps.event.trigger(this.state.markers.get(this.props.active_place.id).marker,"click")),this.props.places!==e.places&&void 0!=this.state.map&&(Array.from(this.state.markers).map(function(e,t){e[1].marker.setMap(null)}),this.updateMarkers(this.state.map)),void 0!==this.state.map&&this.props.data_range!==e.data_range&&this.state.display_cartography&&this.renderCartography()}},{key:"initCache",value:function(){for(var e=0,t=["restaurant","establishment","bar","cafe","beauty_salon","clothing_store","convenvience_store","locksmith","bakery","car_dealer","supermarket"];e<t.length;e++){var a=t[e];this.state.places_cache.set(a,new Map)}console.log("init cache",this.state.places_cache)}},{key:"checkIsCity",value:function(){var e=Object(N.a)(L.a.mark(function e(){var t,a;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(n=this.props.center.lat,r=this.props.center.lng,fetch(U.a+"demo/population/city/"+n+"/"+r).then(function(e){return e.json()}).catch(function(e){return console.error(e)})).then(function(e){return e}).catch(function(e){return console.error("city error",e)});case 2:return t=e.sent,a=Number(t[0].B01003_001E),console.log("RFM",a,a>=1e6),e.abrupt("return",a>=1e6);case 6:case"end":return e.stop()}var n,r},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"clearCartography",value:function(){var e=this;this.state.map.data.forEach(function(t){e.state.map.data.remove(t)})}},{key:"renderCartography",value:function(){var e=this;this.clearCartography(),this.props.data_range==ke?void 0!==this.state.cartography.zip&&this.state.cartography.zip.forEach(function(t){return e.state.map.data.addGeoJson(t)}):"tradeZone"==this.props.data_range&&(void 0!==this.state.cartography.tradezone?this.state.cartography.tradezone.forEach(function(t){t.forEach(function(t){return e.state.map.data.addGeoJson(t)})}):setTimeout(function(){return e.renderCartography()},100))}},{key:"loadCartography",value:function(){var e,t,a,n=this;(function(e,t){var a=U.a+"cart/zip/"+e+"/"+t;return console.log(a),fetch(a).then(function(e){return e.json()}).catch(function(a){ve(),console.error("Zip Cartography Error:",U.a+"cartography/zip/"+e+"/"+t,a)})})(this.props.address.state.toString().toLowerCase(),this.props.address.zip).then(function(e){var t=Object.assign({},n.state.cartography);t.zip=e,n.setState({cartography:t}),n.renderCartography()}),(e=this.props.address.state.toString().toLowerCase(),t=this.props.center.lat,a=this.props.center.lng,fetch(U.a+"cart/tradezone/"+e+"/"+t+"/"+a).then(function(e){return e.json()}).catch(function(n){ve(),console.error("Trade Zone Cartography Error:",U.a+"zcartography/tradezone/"+e+"/"+t+"/"+a,n)})).then(function(e){var t=Object.assign({},n.state.cartography);t.tradezone=e,n.setState({cartography:t})})}},{key:"loadDefaultPlaces",value:function(){var e=Object(N.a)(L.a.mark(function e(){var t=this;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.state.places_cache),e.next=3,x(this.props.address,this.props.business_type,function(e,a){var n=t.props.places.concat(e);t.setState({places:n});var r=!0,s=!1,o=void 0;try{for(var c,i=n[Symbol.iterator]();!(r=(c=i.next()).done);r=!0){var l=c.value;t.state.places_cache.get(t.state.business_type).has(l.place_id)||t.state.places_cache.get(t.state.business_type).set(l.place_id,l)}}catch(p){s=!0,o=p}finally{try{r||null==i.return||i.return()}finally{if(s)throw o}}t.setState({token:a},function(){t.onUpdatePlaces(e)}),t.setState({places_count:20})});case 3:e.sent;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadPlaceType",value:function(e){var t=this;x(this.props.address,e,function(e,a){var n=t.props.places.concat(e);t.setState({places:n}),t.setState({token:a},function(){t.onUpdatePlaces(e)})})}},{key:"loadAllPlaces",value:function(){var e=this;x(this.props.address,"establishment",function(t,a){var n=e.props.places.concat(t);e.setState({places:n}),e.setState({places_count:20}),e.setState({token:a},function(){e.onUpdatePlaces(t)})})}},{key:"loadMorePlaces",value:function(e,t,a){var n,r,s=this,o=Array.from(this.state.places_cache.get(this.state.business_type).values());if(o.length>e){console.log("pull from cache",e,o.length);var c=this.props.places.concat(o.slice(e,e+20));this.setState({places:c},function(){s.onUpdatePlaces(c),t&&a()})}else console.log("load more",e,o.length),n=this.state.token,r=function(e,n){s.setState({token:n});var r=s.props.places.concat(e),o=!0,c=!1,i=void 0;try{for(var l,p=r[Symbol.iterator]();!(o=(l=p.next()).done);o=!0){var u=l.value;s.state.places_cache.get(s.state.business_type).has(u.place_id)||s.state.places_cache.get(s.state.business_type).set(u.place_id,u)}}catch(d){c=!0,i=d}finally{try{o||null==p.return||p.return()}finally{if(c)throw i}}s.setState({places:r},function(){s.onUpdatePlaces(r),t&&a()})},null!=n&&fetch(U.a+"places/pages/"+n,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return n=e.headers.get("Pragma"),e.json()}).then(function(e){return r(e,n)}).catch(function(e){return console.error("Error:",e)})}},{key:"lessPlaces",value:function(){if(this.props.places.length>20){var e=this.props.places;e=e.slice(0,e.length-20),this.setState({places:e}),this.onUpdatePlaces(e)}}},{key:"onBusinessFormChange",value:function(e){this.setState({places_count:20}),this.setState(Object(C.a)({},e.target.name,e.target.value)),this.loadPlaceType(e.target.value)}},{key:"onPlacesCountChange",value:function(e){var t=this;switch(this.setState({places_count:e.target.value}),e.target.value){case"20":a=(a=this.props.places).slice(0,20),this.setState({places:a}),this.onUpdatePlaces(a);break;case"40":if(this.props.places.length<40)this.loadMorePlaces(20,!1);else a=(a=this.props.places).slice(0,40),this.setState({places:a}),this.onUpdatePlaces(a);break;case"60":if(this.props.places.length<40)this.loadMorePlaces(20,!0,function(){return t.loadMorePlaces(40,!1)});else if(40==this.state.places.length)this.loadMorePlaces(40,!1);else{var a;a=(a=this.props.places).slice(0,60),this.setState({places:a}),this.onUpdatePlaces(a)}}}},{key:"onUpdatePlaces",value:function(e){this.props.onUpdatePlaces(e)}},{key:"onUpdateActivePlace",value:function(e){this.props.onUpdateActivePlace(e)}},{key:"onUpdateTract",value:function(e){this.props.onUpdateTract(e)}},{key:"getInfoContent",value:function(e){return function(e){var t=this.state.place_details.get(e.id),a=this.state.place_photos.get(e.id);return r.a.createElement("div",{id:"content"},r.a.createElement("div",{id:"siteNotice"}),r.a.createElement("h3",{style:{textAlign:"center"}},e.name),r.a.createElement("br",null),r.a.createElement("img",{style:{display:"block",marginRight:"auto",marginLeft:"auto",width:"50%"},src:a}),r.a.createElement("br",null),r.a.createElement("div",{id:"bodyContent"},r.a.createElement("p",{style:{textAlign:"center"}},r.a.createElement("strong",null,t.formatted_address)),r.a.createElement("p",null,r.a.createElement("a",{target:"_blank",href:t.website},t.website)),r.a.createElement("p",null,"Rating: ",e.rating," / 5.0",r.a.createElement("br",null),"Total Ratings: ",e.user_ratings_total,r.a.createElement("br",null),"Open Now: ",this.getOpen(e.opening_hours))))}.apply(this,[e])}},{key:"updateRadii",value:function(){if(void 0!=this.state.isCity)if(console.log("RFM",this.state.isCity),this.state.isCity){Ze(402,"#00ff00",this.state.map,this.state.center),Ze(804,"#ffff00",this.state.map,this.state.center);var e=Be(this.state.center,.402);Fe("circle1",e[0],this.state.map,"0.25 miles",Ke),e=Be(this.state.center,.804),Fe("circle1",e[0],this.state.map,"0.5 miles",Ge)}else if(!this.state.isCity){Ze(4828,"#00ff00",this.state.map,this.state.center),Ze(8046,"#ffff00",this.state.map,this.state.center);var t=Be(this.state.center,4.828);Fe("circle1",t[0],this.state.map,"3 miles",Ke);t=Be(this.state.center,8.046),Fe("circle1",t[0],this.state.map,"5 miles",Ge)}}},{key:"updatePlaceDetails",value:function(e){var t=this;this.state.place_details.has(this.props.active_place.id)?e():this.getPlaceDetails(this.state.map,this.props.active_place.place_id,function(a){t.state.place_details.set(t.props.active_place.id,a),t.state.place_photos.has(t.props.active_place.id)||(void 0!==t.props.active_place.photos?function(e,t,a,n){fetch(U.a+"places/photos/"+e+"/"+t+"/"+a,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return n(e)}).catch(function(e){return console.error("Photo fetch error:",e)})}(t.props.active_place.photos[0].photo_reference,400,400,function(a){t.state.place_photos.set(t.props.active_place.id,a.url),e()}):e())})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"map_container"},r.a.createElement(function(){return r.a.createElement("div",{className:"map-control_bar"},r.a.createElement("div",{style:{marginLeft:"5%"}},r.a.createElement("p",{style:{textAlign:"center",marginBottom:"-3%"}}," Zone"),r.a.createElement(Je,{switchFunction:e.handleSwitch})),r.a.createElement("div",{style:{marginLeft:"5%"}},r.a.createElement("p",{style:{textAlign:"center",marginBottom:"0%"}}," Business Type"),r.a.createElement(f.a.Control,{textAlign:"center",value:e.state.business_type,as:"select",name:"business_type",onChange:e.onBusinessFormChange,style:{width:"200px",textAlign:"center",display:"inline",marginLeft:"75px",marginRight:"75px"}},r.a.createElement("option",null,"restaurant"),r.a.createElement("option",null,"establishment"),r.a.createElement("option",null,"bar"),r.a.createElement("option",null,"cafe"),r.a.createElement("option",null,"beauty_salon"),r.a.createElement("option",null,"clothing_store"),r.a.createElement("option",null,"convenvience_store"),r.a.createElement("option",null,"locksmith"),r.a.createElement("option",null,"bakery"),r.a.createElement("option",null,"car_dealer"),r.a.createElement("option",null,"supermarket"))),r.a.createElement("div",{style:{marginLeft:"5%"}},r.a.createElement("p",{style:{textAlign:"center",marginBottom:"0%"}}," Results"),r.a.createElement(f.a.Control,{textAlign:"center",value:e.state.places_count,as:"select",name:"places_count",onChange:e.onPlacesCountChange,style:{width:"100px",textAlign:"center",display:"inline",float:"right"}},r.a.createElement("option",null,"20"),r.a.createElement("option",null,"40"),r.a.createElement("option",null,"60"))))},null),r.a.createElement("div",{style:{height:this.props.height}},r.a.createElement(Me.a,{options:U.e,bootstrapURLKeys:{key:U.b},defaultCenter:this.props.center,defaultZoom:this.props.zoom,center:this.state.center,yesIWantToUseGoogleMapApiInternals:!0,layerTypes:["TrafficLayer","TransitLayer"],id:"map",onGoogleApiLoaded:function(t){var a=t.map;t.maps;return function(t,a,n){e.state.map=t;var r=Fe(void 0,n,t,"Your Business","http://maps.google.com/mapfiles/ms/icons/blue-dot.png"),s="<h3>Your "+e.props.business_type.toString()+"</h3>";r.addListener("click",function(){Qe.setContent(s),Qe.open(t,r),Qe.marker=r,console.log(Qe)}),e.loadCartography()}(a,0,e.state.center)}})))}}]),t}(n.Component);Xe.defaultProps={defaultCenter:{lat:59.95,lng:30.33},defaultzoom:11};var Ve=Object(D.a)(X,W,Y,J,ee,V,q,Q,function(e,t,a,n,r,s,o,c){return{places:e,active_place:t,address:a,business_type:n,zip:r,state:s,tract:o,data_range:c}}),qe={onUpdatePlaces:function(e){return{type:xe,payload:{places:e}}},onUpdateActivePlace:Te,onUpdateTract:function(e){return{type:De,payload:{tract:e}}}},$e=Object(R.b)(Ve,qe)(Xe),et=a(42);var tt=a(164);var at=Object(et.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case ge:return console.log("payload",n),n.user;case ye:return n.user;default:return e}},address:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case G:return n.address;default:return e}},places:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case xe:return n.places;default:return e}},business_type:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case z:return n.business_type;default:return e}},active_place:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case ze:return n.active_place;default:return e}},zip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case H:return n.zip;default:return e}},state:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case K:return n.state;default:return e}},tract:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case De:return n.tract;default:return e}},data_range:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case Ee:return n.data_range;default:return e}},ready:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case I:return n.ready;default:return e}}}),nt=Object(et.d)(Object(et.a)(tt.a)),rt=Object(et.e)(at,{user:"Rob",address:void 0,places:[],business_type:"restaurant",active_place:void 0,state:void 0,zip:void 0,tract:void 0,data_range:ke,ready:!1},nt);console.log("store init state: ",rt.getState());var st=rt,ot=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e))).state=st.getState(),a.onUpdateActivePlace=a.onUpdateActivePlace.bind(Object(w.a)(a)),a.activatePlace=a.activatePlace.bind(Object(w.a)(a)),st.subscribe(function(){a.setState(st.getState())}),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"onUpdateActivePlace",value:function(e){this.props.onUpdateActivePlace(e)}},{key:"activatePlace",value:function(e){console.log("click"),this.onUpdateActivePlace(e.target.value)}},{key:"render",value:function(){var e,t=this;return e=void 0!==this.props.places?this.props.places.map(function(e,a){return r.a.createElement("tr",{key:a,onClick:function(){return t.onUpdateActivePlace(e)}},r.a.createElement("td",null,a+1),r.a.createElement("td",null,e.name),r.a.createElement("td",null,r.a.createElement("img",{src:e.icon,style:{width:"32px",height:"32px"}})))}):r.a.createElement("div",null),r.a.createElement("div",{className:"places-list"},r.a.createElement("br",null),r.a.createElement("p",{style:{textAlign:"center"}},r.a.createElement("strong",null,"Nearby Businesses")),r.a.createElement(ue.a,{striped:!0,bordered:!0,hover:!0,variant:"dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Name"))),r.a.createElement("tbody",null,e)))}}]),t}(r.a.Component),ct=Object(D.a)(function(e){return e.active_place},function(e){return e}),it=Object(D.a)(function(e){return e.places},function(e){return e}),lt=Object(D.a)(ct,it,function(e,t){return{active_place:e,places:t}}),pt={onUpdateActivePlace:Te},ut=Object(R.b)(lt,pt)(ot),dt=(a(253),a(44)),ht=a(165),mt=function(e){function t(e){return Object(c.a)(this,t),Object(l.a)(this,Object(p.a)(t).call(this,e))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(console.log("store",this.props),window.scrollTo({top:0,behavior:"smooth"}),this.props.ready){console.log("sign",this.props.address.coords.lat.toString(),this.props.address.coords.lng.toString(),"/maps/api/streetview?size=600x200&location="+this.props.address.coords.lat.toString()+","+this.props.address.coords.lng.toString()+"&heading=151.78&pitch=-0.76&key="+U.b);this.props.address.coords;var e=r.a.createElement("div",null,r.a.createElement("div",{className:"results-container"},r.a.createElement(Pe,{business_type:this.props.business_type,street:this.props.address.street,city:this.props.address.city,state:this.props.address.state,zip:this.props.address.zip,lat:this.props.address.coords.lat,lng:this.props.address.coords.lng,orientation:"demographics-list-vertical "}),r.a.createElement($e,{height:"75vh",address:this.props.address,center:this.props.address.coords,zoom:15,business_type:this.props.business_type}),r.a.createElement(ut,null)),r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(dt.StaticGoogleMap,{size:"600x200",maptype:"satellite",zoom:"18",apiKey:U.b},r.a.createElement(dt.Marker.Group,{label:"You",color:"brown"},r.a.createElement(dt.Marker,{location:this.props.address.coords}))),r.a.createElement("img",{src:"https://maps.googleapis.com"+Object(ht.a)("/maps/api/streetview?size=600x200&location="+this.props.address.coords.lat.toString()+","+this.props.address.coords.lng.toString()+"&heading=0&pitch=0&sensor=false&key="+U.b)})));r.a.createElement("div",null,r.a.createElement("div",{className:"results-container"},r.a.createElement(Pe,{business_type:this.props.business_type,street:this.props.address.street,city:this.props.address.city,state:this.props.address.state,zip:this.props.address.zip,lat:this.props.address.coords.lat,lng:this.props.address.coords.lng,orientation:"demographics-list-vertical "}),r.a.createElement("div",{style:{width:"80%",backgroundColor:"black",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{margin:"auto"}},r.a.createElement(dt.StaticGoogleMap,{size:"2200x800",maptype:"satellite",zoom:"18",apiKey:U.b},r.a.createElement(dt.Marker.Group,{label:"You",color:"brown"},r.a.createElement(dt.Marker,{location:this.props.address.coords}))))),r.a.createElement(ut,null)),r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{width:"20%",height:"10%"}},r.a.createElement($e,{height:"25vh",address:this.props.address,center:this.props.address.coords,zoom:15,business_type:this.props.business_type})))),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(Pe,{business_type:this.props.business_type,street:this.props.address.street,city:this.props.address.city,state:this.props.address.state,zip:this.props.address.zip,lat:this.props.address.coords.lat,lng:this.props.address.coords.lng,orientation:"demographics-list-horizontal"}))}return r.a.createElement("div",null,r.a.createElement(O,null),e,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(le,null))))}}]),t}(r.a.Component),ft=Object(D.a)($,Y,J,te,function(e,t,a,n){return{user:e,address:t,business_type:a,ready:n}}),gt=Object(R.b)(ft)(mt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var yt=a(166),vt=document.getElementById("root");o.a.render(r.a.createElement(R.a,{store:st},r.a.createElement(yt.a,{basename:"/Landmark-Frontend"},r.a.createElement(gt,null))),vt),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r}),a.d(t,"d",function(){return s}),a.d(t,"c",function(){return o}),a.d(t,"e",function(){return c});var n="https://landmark-backend-252701.appspot.com/",r="AIzaSyDc1QhQx9sfS2E-ZdM0cDQuVtM_NlQhdSU",s=window.google,o="lpkXmFKRjuqOM9YXgLIrGRlPWIA=",c={streetViewControl:!0,scaleControl:!0,fullscreenControl:!1,styles:[{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}],gestureHandling:"greedy",disableDoubleClickZoom:!0,minZoom:5,maxZoom:100,mapTypeControl:!0,mapTypeId:s.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:s.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:s.maps.ControlPosition.BOTTOM_CENTER,mapTypeIds:[s.maps.MapTypeId.ROADMAP,s.maps.MapTypeId.SATELLITE,s.maps.MapTypeId.HYBRID]},zoomControl:!0,clickableIcons:!1}},74:function(e,t,a){}},[[168,1,2]]]);
//# sourceMappingURL=main.0fc7421b.chunk.js.map